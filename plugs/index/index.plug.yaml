name: index
functions:
  # Public API
  extractFrontmatter:
    path: api.ts:extractFrontmatter
    syscall: index.extractFrontmatter
  patchFrontmatter:
    path: api.ts:patchFrontmatter
    syscall: index.patchFrontmatter
  text:
    path: index.ts:indexMarkdown
    syscall: index.markdown

  # YAML syscalls
  yamlParse:
    path: yaml.ts:parse
    syscall: yaml.parse

  yamlStringify:
    path: yaml.ts:stringify
    syscall: yaml.stringify

  reindexSpaceCommand:
    path: "./command.ts:reindexCommand"
    command:
      name: "Space: Reindex"
      requireMode: rw

  processIndexQueue:
    path: ./queue.ts:processIndexQueue
    mqSubscriptions:
      - queue: indexQueue
        batchSize: 3
        autoAck: true

  indexDocument:
    path: "./document.ts:indexDocument"
    events:
      - document:index

  indexPage:
    path: index.ts:indexPage
    events:
      - page:index

  # Headers
  headerComplete:
    path: header.ts:headerComplete
    events:
      - editor:complete

  # Hashtags
  tagComplete:
    path: tags.ts:tagComplete
    events:
      - editor:complete

  frontmatterComplete:
    path: frontmatter.ts:frontmatterComplete
    events:
      - editor:complete

  renamePageCommand:
    path: "./refactor.ts:renamePageCommand"
    command:
      name: "Page: Rename"
      page: ""
      requireMode: rw
      requireEditor: page
  renamePrefixCommand:
    path: "./refactor.ts:renamePrefixCommand"
    command:
      name: "Page: Batch Rename Prefix"
      requireMode: rw
      requireEditor: page
  renamePageLinkCommand:
    path: "./refactor.ts:renamePageLinkCommand"
    command:
      name: "Page: Rename Linked Page"
      requireMode: rw
      requireEditor: page

  # Refactoring Commands

  renameDocumentCommand:
    path: "./refactor.ts:renameDocumentCommand"
    command:
      name: "Document: Rename Document"
      requireMode: rw
      requireEditor: notpage

  extractToPageCommand:
    path: ./refactor.ts:extractToPageCommand
    command:
      name: "Page: Extract"
      requireMode: rw
      requireEditor: page

  refreshWidgets:
    path: widget.ts:refreshWidgets

  lintYAML:
    path: lint.ts:lintYAML
    events:
      - editor:lint

  lintLua:
    path: lint.ts:lintLua
    events:
      - editor:lint

  # Tasks
  updateTaskState:
    path: task.ts:updateTaskState

  taskToggle:
    path: "./task.ts:taskToggle"
    events:
      - page:click
  taskToggleCommand:
    path: ./task.ts:taskCycleCommand
    command:
      name: "Task: Cycle State"
      key: Mod-. t
      requireMode: rw
      requireEditor: page

  taskComplete:
    path: ./complete.ts:completeTaskState
    events:
      - editor:complete

  removeCompletedTasksCommand:
    path: task.ts:removeCompletedTasksCommand
    command:
      name: "Task: Remove Completed"
      requireMode: rw
      requireEditor: page
